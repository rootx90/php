 شرح مبسط ومفصل لكيفية عمل الدوال (Functions) في PHP، وأسباب استخدامها مع أمثلة عملية من تطبيقات الواقع.

---


# شرح كيفية عمل الدوال (Functions) في PHP ومتى نستخدمها

الدوال (Functions) هي عبارة عن قطع من الكود تُجمع معًا تحت اسم معين، ويمكن استدعاؤها في أي مكان داخل البرنامج. هذا يجعل الكود أكثر تنظيمًا، ويسهل إعادة استخدامه وصيانته.

---

## **أهمية الدوال**

1. **تنظيم الكود**: تساعد الدوال على تقسيم البرنامج إلى أجزاء صغيرة يمكن فهمها وإدارتها بسهولة.
2. **إعادة الاستخدام**: بدلاً من كتابة نفس الكود مرارًا وتكرارًا، نقوم بكتابة دالة واحدة ثم نستدعيها عند الحاجة.
3. **الصيانة والتعديل**: عند الحاجة لتعديل وظيفة معينة، يكفي تعديل الكود داخل الدالة دون الحاجة للبحث في جميع أنحاء البرنامج.
4. **التقسيم المنطقي**: تقسيم البرنامج إلى وظائف منفصلة يجعل من السهل اختبار كل جزء على حدة.

---

## **كيف تعمل الدوال؟**

### **البنية الأساسية للدالة:**

```php
function functionName($parameter1, $parameter2, ...) {
    // الكود الذي ينفذ عند استدعاء الدالة
    return $result; // اختياري: لإرجاع نتيجة معينة
}
```

- **`functionName`**: اسم الدالة الذي تختاره لتمثيل الوظيفة.
- **`$parameter1, $parameter2, ...`**: المعاملات التي تُمرر إلى الدالة لاستخدامها داخلها.
- **`return`**: تعيد القيمة النهائية التي ينتجها الكود داخل الدالة (يمكن أن تكون اختياريًا).

### **خطوات استخدام الدوال:**

1. **تعريف الدالة**: نكتب الكود الذي نريد تنفيذه داخل الدالة.
2. **استدعاء الدالة**: نقوم باستدعاء الدالة باستخدام اسمها وتمرير المعاملات المطلوبة (إن وجدت).
3. **إعادة الاستخدام**: يمكننا استدعاء الدالة في أي مكان في البرنامج دون الحاجة لكتابة نفس الكود مرارًا.

---

## **متى نستخدم الدوال؟**

- **الكود المتكرر**: إذا كان لديك كود يتكرر في أماكن متعددة، ضع هذا الكود داخل دالة واستدعها عند الحاجة.
- **تقسيم البرنامج**: لتقسيم برنامج معقد إلى أجزاء صغيرة (مثل التحقق من بيانات المستخدم أو حساب نتيجة معينة).
- **تنفيذ عمليات حسابية أو معالجة بيانات**: يمكن تجميع العمليات الحسابية المعقدة داخل دوال لإرجاع النتائج بسهولة.
- **الوضوح والتنظيم**: يساعد استخدام الدوال في جعل الكود واضحًا وسهل القراءة والصيانة.

---

## **أمثلة من تطبيقات الواقع**

### **1. نظام تسجيل الدخول باستخدام دالة**

#### **المشكلة**: التحقق من صحة بيانات المستخدم المدخلة (اسم المستخدم وكلمة المرور).

#### **الكود:**

```php
function validateLogin($username, $password) {
    // مجموعة بيانات تمثل قاعدة بيانات للمستخدمين
    $users = [
        ["username" => "admin", "password" => "password123"],
        ["username" => "user1", "password" => "pass456"]
    ];

    // التحقق من صحة بيانات الدخول
    foreach ($users as $user) {
        if ($user["username"] === $username && $user["password"] === $password) {
            return true; // تسجيل الدخول ناجح
        }
    }
    return false; // تسجيل الدخول فاشل
}

// استدعاء الدالة
$inputUsername = "admin";
$inputPassword = "password123";

if (validateLogin($inputUsername, $inputPassword)) {
    echo "مرحبًا! تم تسجيل الدخول بنجاح.";
} else {
    echo "خطأ: اسم المستخدم أو كلمة المرور غير صحيحة.";
}
```

#### **الشرح:**
- **تعريف الدالة**: يتم تعريف الدالة `validateLogin` التي تقارن بيانات المستخدم مع مجموعة بيانات (محاكاة لقاعدة بيانات).
- **الاستدعاء**: عند استدعاء الدالة ببيانات المستخدم، يتم فحصها وإرجاع `true` إذا كانت صحيحة أو `false` إذا كانت خاطئة.
- **الفائدة**: يجعل الكود قابلًا لإعادة الاستخدام في أي جزء من البرنامج يحتاج التحقق من بيانات المستخدم.

---

### **2. حساب السعر النهائي بعد الخصم باستخدام دالة**

#### **المشكلة**: حساب السعر النهائي للمنتج بعد تطبيق خصم معين.

#### **الكود:**

```php
function calculateFinalPrice($originalPrice, $discountPercentage) {
    $discountAmount = ($originalPrice * $discountPercentage) / 100;
    $finalPrice = $originalPrice - $discountAmount;
    return $finalPrice;
}

// استدعاء الدالة
$productPrice = 100;
$discount = 20;

echo "السعر النهائي: $" . calculateFinalPrice($productPrice, $discount);
```

#### **الشرح:**
- **وظيفة الدالة**: تأخذ الدالة السعر الأصلي ونسبة الخصم، ثم تحسب المبلغ المخصوم والسعر النهائي.
- **الفائدة**: يمكن استخدام الدالة في تطبيقات التجارة الإلكترونية لتحديث الأسعار بسهولة.

---

### **3. عرض قائمة المنتجات باستخدام دالة**

#### **المشكلة**: عرض قائمة المنتجات بطريقة مرتبة.

#### **الكود:**

```php
function displayProducts($products) {
    foreach ($products as $product) {
        echo "اسم المنتج: " . $product["name"] . ", السعر: $" . $product["price"] . "\n";
    }
}

// استدعاء الدالة
$products = [
    ["name" => "لابتوب", "price" => 1200],
    ["name" => "هاتف", "price" => 800],
    ["name" => "تابلت", "price" => 400]
];

displayProducts($products);
```

#### **الشرح:**
- **وظيفة الدالة**: تقوم الدالة `displayProducts` بعرض تفاصيل كل منتج موجود في مصفوفة المنتجات.
- **الفائدة**: يجعل الكود أكثر نظافة ويمكن إعادة استخدام الدالة في صفحات عرض المنتجات.

---

### **4. تحليل ملف CSV باستخدام دالة**

#### **المشكلة**: قراءة ملف CSV وتحليل بياناته إلى مصفوفة منظمة.

#### **الكود:**

```php
function parseCSV($filePath) {
    $file = fopen($filePath, "r");
    $headers = fgetcsv($file); // قراءة العناوين من الصف الأول
    $data = [];

    while ($row = fgetcsv($file)) {
        $rowData = [];
        foreach ($headers as $index => $header) {
            $rowData[$header] = $row[$index];
        }
        $data[] = $rowData;
    }

    fclose($file);
    return $data;
}

// استدعاء الدالة
$parsedData = parseCSV("data.csv");

foreach ($parsedData as $record) {
    echo "الاسم: " . $record["Name"] . ", العمر: " . $record["Age"] . "\n";
}
```

#### **الشرح:**
- **وظيفة الدالة**: تقرأ الدالة ملف CSV وتربط كل قيمة بعنوانها، ثم تُعيد مصفوفة مرتبة.
- **الفائدة**: تُستخدم هذه الدالة لتحليل بيانات الملفات بسهولة وتحويلها إلى شكل يمكن التعامل معه برمجياً.

---

### **5. لعبة تخمين الرقم باستخدام دالة**

#### **المشكلة**: لعبة تفاعلية يحاول المستخدم فيها تخمين رقم عشوائي.

#### **الكود:**

```php
function guessNumberGame() {
    $numberToGuess = rand(1, 100); // اختيار رقم عشوائي بين 1 و 100
    $attempts = 0;

    do {
        $guess = (int)readline("ادخل رقم: ");
        $attempts++;

        if ($guess > $numberToGuess) {
            echo "مرتفع جدًا!\n";
        } elseif ($guess < $numberToGuess) {
            echo "منخفض جدًا!\n";
        } else {
            echo "تهانينا! لقد خمنت الرقم بعد $attempts محاولة.";
            return;
        }
    } while (true);
}

// استدعاء الدالة لبدء اللعبة
guessNumberGame();
```

#### **الشرح:**
- **وظيفة الدالة**: تدير اللعبة عن طريق اختيار رقم عشوائي وتطلب من المستخدم تخمينه، مع إعطاء ملاحظات عن كون التخمين أعلى أو أقل من الرقم المطلوب.
- **الفائدة**: تجميع كل من منطق اللعبة في دالة واحدة يجعل البرنامج منظمًا وسهل التطوير أو التعديل.

---

## **كيف تساعدنا الدوال؟**

- **تحسين التنظيم**: تساعد الدوال في تقسيم البرنامج إلى أجزاء صغيرة ومفهومة.
- **إعادة الاستخدام**: يمكنك استدعاء نفس الدالة في أجزاء مختلفة من البرنامج دون إعادة كتابة الكود.
- **الصيانة**: في حال تغيير منطق معين، يتم تعديل الدالة فقط دون الحاجة لتعديل الكود في كل مكان.
- **التقسيم المنطقي**: يجعل البرنامج أكثر وضوحًا وتنظيمًا مما يسهل عملية التطوير والتحليل.

---

## **الخلاصة**

- **استخدم الدوال** عندما تحتاج إلى تنظيم الكود وإعادة استخدامه.
- **قسم برنامجك** إلى وظائف صغيرة من خلال الدوال لتسهيل الصيانة.
- **الدوال** تجعل الكود أكثر وضوحًا ومرونة، مما يحسن جودة البرنامج بشكل عام.

هذه الأمثلة والشرح البسيط يوضحان كيف يمكن استخدام الدوال في PHP لحل مشكلات برمجية واقعية بطريقة فعالة ومنظمة.

```
